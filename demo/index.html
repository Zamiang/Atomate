<!doctype html>
<!--[if lt IE 7 ]> <html class="no-js ie6" lang="en"> <![endif]-->
<!--[if IE 7 ]>    <html class="no-js ie7" lang="en"> <![endif]-->
<!--[if IE 8 ]>    <html class="no-js ie8" lang="en"> <![endif]-->
<!--[if (gte IE 9)|!(IE)]><!--> <html class="no-js" lang="en"> <!--<![endif]-->
    <head>
        <meta name="google-site-verification" content="mip2rw9r2ei7TFIBvcoPNHmmsu2B-mtLFg-9XKdcT8A" />
        <title>Atomate - demo</title>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
        <meta property="og:title" content="Atomate - Your digital personal assistant">
        <meta property="og:app_id" content="122681067752275">
        <meta property="og:site_name" content="Atomate">
        <meta property="og:image" content="http://atomate.me/img/atomate_logo.png">
        <meta property="og:url" content="http://atomate.me">
        <meta property="og:type" content="website">
        <meta property="og:description" content="Atomate helps you stay organized by giving you one place to find and update all the things you need for you day. It parties responsibly">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <link rel="shortcut icon" href="favicon.ico">
        <link rel="stylesheet" href="css/styles.css?v=2">
    </head>
    <body>
        <a href="http://github.com/Zamiang/Atomate">
            <img style="position: absolute; top: 0; left: 0; border: 0;" src="https://d3nwyuy0nl342s.cloudfront.net/img/5d21241b64dc708fcbb701f68f72f41e9f1fadd6/687474703a2f2f73332e616d617a6f6e6177732e636f6d2f6769746875622f726962626f6e732f666f726b6d655f6c6566745f7265645f6161303030302e706e67" alt="Fork me on GitHub">
        </a>

        <p style="position:absolute; top:10px; right:10px;"><fb:login-button autologoutlink="true"></fb:login-button></p>

        <header>
            <h1>Atomate</h1>
            <img class="logo" src="../img/atomate_bot.png" />
            <h2>Your digital personal assistant</h2>
        </header>
        <div id="container">
            <!--
                <ul id="instructions">
                    <img class="remove" src="../img/remove.png">
                    <li>Double-click to edit.</li>
                    <li>Search or enter to add notes</li>
                </ul>
                -->
            <div id="input">
                <textarea id="main_input" rows="1" cols="52"></textarea>
                <div class="controls clearfix">
                    <input id="id_note_save" type="submit" value="Save" class="notes_save_btn" />
                    <div class="location_input">
                        <label>Location:</label>
                        <select>
                            <option val="none">None</option>
                        </select>

                        <label>Time:</label>
                        <input type="text" placeholder="6/25/2011" class="picker_date"/>
                        <input type="text" placeholder="10:30pm" class="picker_time" />
                    </div>
                </div>
            </div>

            <ul id="tabs">
                <div class="selected settings">
                    <div class="settings_img"><img src="../img/settings_16.png" /></div>
                    <ul class="settings_list">
                        <li>
                            <a href="print.html">Print View</a>
                        </li>
                        <li>
                            <a href="trashbin.html">Trash Bin</a>
                        </li>
                        <li data-type="settings" data-name="settings" class="tab_settings">
                            <a href="#settings">Account Settings</a>
                        </li>
                    </ul>
                </div>
            </ul>

            <div id="main" role="main">
                <ul id="notes"></ul>

                <div id="settings">
                    <h1>Atomate Settings</h1>
                    <h2>Synced Services</h2>
                    <ul class="services">
                        <li data-id="gcal">
                            <img src="../img/gcal.png" />
                            <b>Google Calendar</b>
                        </li>
                        <li data-id="gcontacts">
                            <img src="../img/gcontacts.png" />
                            <b>Google Contacts</b>
                        </li>
                        <li data-id="listit">
                            <img src="../img/listit.png" />
                            <b>List-it</b>
                        </li>
                    </ul>
                    <h2>Add Services</h2>
                    <ul class="services">
                        <li>
                            <img src="../img/facebook.png" />
                            <b>Facebook</b>
                        </li>
                        <li>
                            <img src="../img/twitter.png" />
                            <b>Twitter</b>
                        </li>
                    </ul>
                    <h2>Account Settings</h2>
                    <ul class="form">
                        <li class="form_container">
                            <label><b>Email</b></label>
                            <input id="id_email" type="text" />
                        </li>
                        <li class="form_container">
                            <label><b>Password</b></label>
                            <input id="id_old_password" type="text" />
                        </li>
                        <li class="form_container">
                            <label><b>Font Size</b></label><br />
                            <select>
                                <option val="8">8</option>
                                <option val="10">10</option>
                                <option val="12" selected>12</option>
                                <option val="14">14</option>
                                <option val="16">16</option>
                                <option val="18">18</option>
                                <option val="events">Events</option>
                            </select>
                        </li>
                        <li class="form_container">
                            <input id="id_notifications" type="checkbox" checked />
                            <label>Email me with updates from Atomate</label>
                        </li>
                        <li class="form_container">
                            <input id="id_errors" type="checkbox" checked />
                            <label>Email me when Atomate encounters an error</label>
                        </li>
                        <li class="form_spacer">
                            <input id="id_submit" type="submit" value="Save" />
                        </li>
                    </ul>
                </div>
            </div>
        </div>

        <ul id="add_tab" class="popup form">
            <img class="remove top_remove" src="../img/remove.png">
            <h1>Edit your tabs</h1>
            <ul id="sort_tabs"></ul>

            <div class="add_tab form_container">
                <h1>Add a tab</h1><br />
                <label>Use an Atomate tab:</label>

                <select>
                    <option val="none">none</option>
                    <option val="now">Now</option>
                    <option val="notes">Notes</option>
                    <option val="todo">Todo</option>
                    <option val="events">Events</option>
                </select>
            </div>
            <div class="form_container">
                <label>Save a search:</label>
                <input id="id_tab_search" type="text" />
                <input id="id_tab_add_submit" type="submit" value="Add a tab" />
            </div>

            <div class="form_spacer">
                <input id="id_tab_add_submit" type="submit" value="Save" />
            </div>
        </ul>

        <ul id="progress"></ul>

        <footer>
            <a href="/about.html">About</a> &#8226;
            <a href="/team.html">Team</a> &#8226;
            <a href="/demo.html">Demo</a> &#8226;
            <a href="https://github.com/Zamiang/Atomate">Source</a> &#8226;
            <a href="/help">Help</a>
            <div id="fb-root"></div>
        </footer>

        <script type="text/javascript" src="///www.google.com/jsapi"></script>
        <script src="../lib/jquery.min.js"></script>
        <script src="../lib/jquery.ui.min.js"></script>
        <script src="../lib/underscore.js"></script>
        <script src="../lib/backbone.js"></script>
        <script src="../lib/dateformat.js"></script>

        <script src="../bin/atomate.js"></script>
        <script src="../bin/util.js"></script>
        <script src="../bin/detector.js"></script>
        <script src="../bin/validator.js"></script>
        <script src="../bin/trie.js"></script>
        <script src="../bin/tracking.js"></script>
        <script src="../bin/templates.js"></script>
        <script src="../bin/autocomplete.js"></script>
        <script src="../bin/notes.js"></script>

        <script src="../bin/database.js"></script>
        <script src="../bin/database.notes.js"></script>
        <script src="../bin/database.person.js"></script>

        <script src="../bin/auth.js"></script>
        <script src="../bin/auth.flickr.js"></script>
        <script src="../bin/auth.fb.js"></script>
        <script src="../bin/auth.gcal.js"></script>
        <script src="../bin/auth.gcontacts.js"></script>

        <script>
    // Facebook initialize
    if (window.location.protocol != "file:") {
        (function() {
             var e = document.createElement('script');
             e.type = 'text/javascript';
             e.src = document.location.protocol +
	             '//connect.facebook.net/en_GB/all.js';
             e.async = true;
             document.getElementById('fb-root').appendChild(e);
         }());

        // MIX PANEL
        var mpq = ["init", "d3950de9980b43abe44956d1511c6af5"];
        mixPanelInit = function() {
            try {
                // TODO: email MixPanel about this - to run callbacks they require a global called 'mpmetrics'
                mpmetrics = new MixpanelLib("d3950de9980b43abe44956d1511c6af5");
                return mpmetrics
            } catch(err) {
                var null_fn = function () {};
                mpmetrics = {
                    track: null_fn,
                    track_funnel: null_fn,
                    register: null_fn,
                    register_once: null_fn,
                    register_funnel: null_fn,
                    identify: null_fn
                };
                return mpmetrics
            }
        };
        var _gaq=[["_setAccount","UA-11329288-1"],["_trackPageview"]]; // Change UA-XXXXX-X to be your site's ID
        (function(d,t){var g=d.createElement(t),s=d.getElementsByTagName(t)[0];g.async=1;
                       g.src=("https:"==location.protocol?"//ssl":"//www")+".google-analytics.com/ga.js";
                       s.parentNode.insertBefore(g,s)}(document,"script"));
    }

    jQuery(document).ready(function(){
                               Atomate.initialize({
                                                      //trackingmodule: mpq,
                                                      //mixPanelInit: mixPanelInit,
                                                  });
                           });

    function mapsLoaded() {
        var browserSupportFlag
        
        // Try W3C Geolocation (Preferred)
        if (navigator.geolocation) {
            browserSupportFlag = true;
            navigator.geolocation.getCurrentPosition(function(position) {
                                                         var geocoder = new google.maps.Geocoder();
                                                         var latlng =  new google.maps.LatLng(position.coords.latitude,position.coords.longitude);

                                                     geocoder.geocode({'latLng': latlng}, function(results, status) {
                                                                          if (status == google.maps.GeocoderStatus.OK) {
                                                                              //console.log(results);
                                                                              var loc = results[0]; // todo: be smarter about this
                                                                              Atomate.setLocationFromGeocode(loc,latlng);

                                                                          } else {
                                                                              handleError("Geocoder failed due to: " + status);
                                                                          }
                                                                      });
                                                 }, function() {
                                                     handleNoGeolocation(browserSupportFlag);
                                                 });
            // Browser doesn't support Geolocation
        } else {
            browserSupportFlag = false;
            handleNoGeolocation(browserSupportFlag);
        }
        
        function handleNoGeolocation(errorFlag) {
            if (errorFlag == true) {
                error("Geolocation service failed.");
            } else {
                showMessage("Your browser doesn't support geolocation.");
            }
        }
    }

    // it srsly hurts that all this google crap can't be in an external js file
    // gdata initialize
    if (window.google !== undefined) {           
        google.load("gdata", "2.x", {packages: ["contacts, calendar"]}); // nice of them not to put this in the docs
        google.load("maps", "3.x", {"callback" : mapsLoaded, "other_params" : "sensor=false"});
    }

// A google.gdata.calendar.CalendarService object that can be used to access
// private feed using AuthSub.
var CalendarService;
var ContactsService;
var EVENT_FEED_URL =  "http://www.google.com/calendar/feeds/";
var EVENT_FEED_URL2 = "http://www.google.com/calendar/feeds/default/allcalendars/full";

var CONTACTS_FEED_URL = "https://www.google.com/m8/feeds/";
var CONTACTS_FEED_URL2 = "https://www.google.com/m8/feeds/contacts/default/full";

function showMessage(e) {
    Atomate.auth.logProgress(e);
}

function error(e) {
    Atomate.auth.logError(e);
}

function handleError(e) {
    error(e)
    console.log(e.cause ? e.cause.statusText : e.message);
}

function init() {
    if (google && google.accounts && !google.accounts.user.checkLogin(EVENT_FEED_URL + " " + CONTACTS_FEED_URL + " " + EVENT_FEED_URL2 + " " + CONTACTS_FEED_URL2)){
        login();
    }
    
    try {
        if (google && google.gdata && google.gdata.calendar) {
            CalendarService = new google.gdata.calendar.CalendarService('Atomate.0.4');
            Atomate.auth.gcal.initialize();
        }
        if (google && google.gdata && google.gdata.contacts) {
            ContactsService = new google.gdata.contacts.ContactsService('Atomate.0.4');
            
            //Atomate.auth.gcontacts.initialize(); // TEMPORARY REMOVAL
        }
    }  catch(x){ alert(x); }
}

if (window.google !== undefined) {
    google.setOnLoadCallback(init);
}

function login() {
    token = google.accounts.user.login(EVENT_FEED_URL + " " + CONTACTS_FEED_URL + " " + EVENT_FEED_URL2 + " " + CONTACTS_FEED_URL2);
}
        </script>
    </body>
</html>
